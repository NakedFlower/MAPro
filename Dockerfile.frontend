FROM node:18 AS build
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=build /app/build /usr/share/nginx/html

# nginx는 기본적으로 80포트를 사용
# 컨테이너 실행 시 -p 3000:80으로 매핑됨
EXPOSE 80

# nginx 설정 파일 추가 (선택사항 - SPA 라우팅 지원)
COPY nginx.conf /etc/nginx/conf.d/default.conf

# nginx는 자동으로 실행됨 (기본 CMD 사용)